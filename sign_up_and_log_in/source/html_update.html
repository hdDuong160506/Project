<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 { text-align: center; color: white; margin-bottom: 30px; font-size: 28px; }
        .cards-wrapper { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        @media (max-width: 768px) { .cards-wrapper { grid-template-columns: 1fr; } }
        .card { background: white; border-radius: 16px; padding: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); }
        .card.full-width { grid-column: 1 / -1; }
        .card.disabled { opacity: 0.6; pointer-events: none; position: relative; }
        .card.disabled::after { content: 'ğŸ”’ ÄÃ£ Ä‘Äƒng nháº­p'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(102, 126, 234, 0.95); color: white; padding: 15px 30px; border-radius: 10px; font-weight: bold; font-size: 18px; z-index: 10; }
        .card h2 { color: #667eea; margin-bottom: 20px; font-size: 20px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; color: #333; font-weight: 500; }
        input { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 15px; transition: border-color 0.3s; }
        input:focus { outline: none; border-color: #667eea; }
        button { width: 100%; padding: 12px 24px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 10px; transition: all 0.3s; }
        button:disabled { opacity: 0.6; cursor: not-allowed; }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .btn-primary:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4); }
        .btn-google { background: #fff; color: #333; border: 2px solid #e0e0e0; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-google:hover:not(:disabled) { background: #f5f5f5; }
        .btn-secondary { background: #4CAF50; color: white; }
        .btn-danger { background: #f44336; color: white; }
        .btn-info { background: #2196F3; color: white; }
        .divider { text-align: center; margin: 20px 0; position: relative; }
        .divider::before { content: ''; position: absolute; top: 50%; left: 0; right: 0; height: 1px; background: #e0e0e0; }
        .divider span { background: white; padding: 0 15px; position: relative; color: #999; font-size: 14px; }
        .link-button { background: none; color: #667eea; padding: 5px; font-size: 14px; text-decoration: underline; margin-top: 5px; }
        .link-button:hover:not(:disabled) { color: #764ba2; }
        .info { color: #2196F3; font-style: italic; margin-top: 15px; padding: 12px; background: #e3f2fd; border-radius: 8px; font-size: 14px; }
        .success { color: #4CAF50; background: #e8f5e9; }
        .status-indicator { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 8px; }
        .status-online { background: #4CAF50; }
        .output-section { background: white; border-radius: 16px; padding: 20px; margin-top: 20px; }
        .output-section h2 { color: #667eea; margin-bottom: 15px; font-size: 18px; }
        #output { background-color: #f4f4f4; padding: 15px; border: 2px solid #ddd; border-radius: 8px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New', monospace; font-size: 13px; max-height: 300px; overflow-y: auto; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); justify-content: center; align-items: center; z-index: 1000; }
        .modal.active { display: flex; }
        .modal-content { background: white; border-radius: 16px; padding: 30px; max-width: 400px; width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.3); }
        .modal-content h3 { color: #667eea; margin-bottom: 20px; }
        .otp-input { width: 100%; text-align: center; font-size: 24px; letter-spacing: 10px; padding: 15px; }
        .close-modal { background: #e0e0e0; color: #333; margin-top: 10px; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Authentication System</h1>
        <div class="cards-wrapper">
            <div class="card" id="register-card">
                <h2>ğŸ“ ÄÄƒng kÃ½ tÃ i khoáº£n</h2>
                <form id="register-form">
                    <div class="form-group"><label for="reg-name">TÃªn:</label><input type="text" id="reg-name" required></div>
                    <div class="form-group"><label for="reg-email">Email:</label><input type="email" id="reg-email" placeholder="example@gmail.com, name@outlook.com..." required></div>
                    <div class="form-group"><label for="reg-pwd">Máº­t kháº©u:</label><input type="password" id="reg-pwd" placeholder="Ãt nháº¥t 6 kÃ½ tá»±" required></div>
                    <button type="submit" class="btn-primary">ÄÄƒng kÃ½</button>
                </form>
                <div class="divider"><span>HOáº¶C</span></div>
                <button onclick="loginWithGoogle()" class="btn-google">
                    <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M17.6 9.2l-.1-1.8H9v3.4h4.8C13.6 12 13 13 12 13.6v2.2h3a8.8 8.8 0 0 0 2.6-6.6z" fill="#4285F4"/><path d="M9 18c2.4 0 4.5-.8 6-2.2l-3-2.2a5.4 5.4 0 0 1-8-2.9H1V13a9 9 0 0 0 8 5z" fill="#34A853"/><path d="M4 10.7a5.4 5.4 0 0 1 0-3.4V5H1a9 9 0 0 0 0 8l3-2.3z" fill="#FBBC05"/><path d="M9 3.6c1.3 0 2.5.4 3.4 1.3L15 2.3A9 9 0 0 0 1 5l3 2.4a5.4 5.4 0 0 1 5-3.7z" fill="#EA4335"/></g></svg>
                    ÄÄƒng kÃ½ vá»›i Google
                </button>
                <div class="info">ğŸ’¡ ÄÄƒng kÃ½ báº±ng Email cáº§n xÃ¡c thá»±c. Google tá»± Ä‘á»™ng xÃ¡c thá»±c.<br>
                <small style="color: #f57c00;"><strong>âš ï¸ Quan trá»ng vá»›i Outlook/Hotmail:</strong></small><br>
                <small>1ï¸âƒ£ Kiá»ƒm tra thÆ° má»¥c <strong>Junk Email</strong> (ThÆ° rÃ¡c)</small><br>
                <small>2ï¸âƒ£ Kiá»ƒm tra tab <strong>"Other"</strong> (khÃ´ng pháº£i Focused)</small><br>
                <small>3ï¸âƒ£ Chá» 5-10 phÃºt vÃ¬ Outlook cÃ³ thá»ƒ delay</small><br>
                <small>4ï¸âƒ£ Náº¿u khÃ´ng tháº¥y, hÃ£y Ä‘Äƒng kÃ½ báº±ng Gmail hoáº·c Ä‘Äƒng nháº­p Google</small></div>
            </div>
            <div class="card" id="login-card">
                <h2>ğŸ”‘ ÄÄƒng nháº­p</h2>
                <form id="login-form">
                    <div class="form-group"><label for="login-email">Email:</label><input type="email" id="login-email" required></div>
                    <div class="form-group"><label for="login-pwd">Máº­t kháº©u:</label><input type="password" id="login-pwd" required></div>
                    <button type="submit" class="btn-primary">ÄÄƒng nháº­p</button>
                </form>
                <button onclick="showForgotPassword()" class="link-button">QuÃªn máº­t kháº©u?</button>
                <div class="divider"><span>HOáº¶C</span></div>
                <button onclick="loginWithGoogle()" class="btn-google">
                    <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M17.6 9.2l-.1-1.8H9v3.4h4.8C13.6 12 13 13 12 13.6v2.2h3a8.8 8.8 0 0 0 2.6-6.6z" fill="#4285F4"/><path d="M9 18c2.4 0 4.5-.8 6-2.2l-3-2.2a5.4 5.4 0 0 1-8-2.9H1V13a9 9 0 0 0 8 5z" fill="#34A853"/><path d="M4 10.7a5.4 5.4 0 0 1 0-3.4V5H1a9 9 0 0 0 0 8l3-2.3z" fill="#FBBC05"/><path d="M9 3.6c1.3 0 2.5.4 3.4 1.3L15 2.3A9 9 0 0 0 1 5l3 2.4a5.4 5.4 0 0 1 5-3.7z" fill="#EA4335"/></g></svg>
                    ÄÄƒng nháº­p vá»›i Google
                </button>
            </div>
        </div>
        <div class="card full-width hidden" id="forgot-card">
            <h2>ğŸ” QuÃªn máº­t kháº©u</h2>
            <form id="forgot-form">
                <div class="form-group"><label for="forgot-email">Nháº­p email cá»§a báº¡n:</label><input type="email" id="forgot-email" required></div>
                <button type="submit" class="btn-primary">Gá»­i mÃ£ OTP</button>
            </form>
            <div class="info">ğŸ“§ ChÃºng tÃ´i sáº½ gá»­i mÃ£ OTP 6 sá»‘ Ä‘áº¿n email cá»§a báº¡n.</div>
            <button onclick="hideForgotPassword()" class="link-button">â† Quay láº¡i</button>
        </div>
        <div class="card full-width hidden" id="dashboard-card">
            <h2>âš™ï¸ Dashboard</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                <button id="profile-button" class="btn-info">ğŸ‘¤ Xem Profile</button>
                <button id="refresh-button" class="btn-secondary">ğŸ”„ LÃ m má»›i Token</button>
                <button id="logout-button" class="btn-danger">ğŸšª ÄÄƒng xuáº¥t</button>
            </div>
            <div class="info success" style="margin-top: 15px;"><span class="status-indicator status-online"></span><span>ÄÃ£ Ä‘Äƒng nháº­p thÃ nh cÃ´ng</span></div>
        </div>
        <div class="output-section">
            <h2>ğŸ“Š Káº¿t quáº£:</h2>
            <pre id="output">ChÆ°a cÃ³ hÃ nh Ä‘á»™ng nÃ o. HÃ£y thá»­ Ä‘Äƒng kÃ½ hoáº·c Ä‘Äƒng nháº­p!</pre>
        </div>
    </div>
    <div class="modal" id="otp-modal">
        <div class="modal-content">
            <h3>ğŸ”¢ Nháº­p mÃ£ OTP</h3>
            <p style="color: #666; margin-bottom: 20px;">MÃ£ OTP 6 sá»‘ Ä‘Ã£ Ä‘Æ°á»£c gá»­i Ä‘áº¿n email cá»§a báº¡n.</p>
            <form id="otp-form">
                <div class="form-group"><input type="text" id="otp-input" class="otp-input" maxlength="6" placeholder="000000" required></div>
                <button type="submit" class="btn-primary">XÃ¡c nháº­n</button>
                <button type="button" onclick="closeOtpModal()" class="close-modal">Há»§y</button>
            </form>
        </div>
    </div>
    <div class="modal" id="reset-modal">
        <div class="modal-content">
            <h3>ğŸ”‘ Äáº·t láº¡i máº­t kháº©u</h3>
            <form id="reset-form">
                <div class="form-group"><label for="new-pwd">Máº­t kháº©u má»›i:</label><input type="password" id="new-pwd" placeholder="Ãt nháº¥t 6 kÃ½ tá»±" required></div>
                <div class="form-group"><label for="confirm-pwd">XÃ¡c nháº­n máº­t kháº©u:</label><input type="password" id="confirm-pwd" placeholder="Nháº­p láº¡i máº­t kháº©u" required></div>
                <button type="submit" class="btn-primary">Äáº·t láº¡i máº­t kháº©u</button>
                <button type="button" onclick="closeResetModal()" class="close-modal">Há»§y</button>
            </form>
        </div>
    </div>
    <script>
        let accessToken=null,refreshToken=null,resetToken=null,forgotEmail=null,verifiedEmail=null;
        async function getAndSendLocation(accessToken) {
            if (!navigator.geolocation || !accessToken) return;
            
            navigator.geolocation.getCurrentPosition(
                async (position) => {
                    const lat = position.coords.latitude;
                    const long = position.coords.longitude;
                    
                    try {
                        await fetch(`${API_URL}/update-location`, {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${accessToken}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ lat, long })
                        });
                    } catch (err) {
                        console.log('KhÃ´ng thá»ƒ cáº­p nháº­t vá»‹ trÃ­:', err);
                    }
                },
                (error) => {
                    console.log('KhÃ´ng láº¥y Ä‘Æ°á»£c GPS:', error.code);
                }
            );
        }
        const outputEl=document.getElementById('output'),API_URL='http://127.0.0.1:5000';
        
        function showForgotPassword(){document.getElementById('forgot-card').classList.remove('hidden');document.getElementById('register-card').classList.add('hidden');document.getElementById('login-card').classList.add('hidden');}
        function hideForgotPassword(){document.getElementById('forgot-card').classList.add('hidden');document.getElementById('register-card').classList.remove('hidden');document.getElementById('login-card').classList.remove('hidden');}
        function updateAuthStatus(){const r=document.getElementById('register-card'),l=document.getElementById('login-card'),f=document.getElementById('forgot-card'),d=document.getElementById('dashboard-card');if(accessToken){r.classList.add('disabled');l.classList.add('disabled');f.classList.add('hidden');d.classList.remove('hidden');}else{r.classList.remove('disabled','hidden');l.classList.remove('disabled','hidden');f.classList.add('hidden');d.classList.add('hidden');}}
        function showOutput(data,isError=false){let output=JSON.stringify(data,null,2);if(isError){output='âŒ Lá»–I:\n'+output;outputEl.style.background='#ffebee';outputEl.style.color='#f44336';}else if(data.msg&&(data.msg.includes('thÃ nh cÃ´ng')||data.msg.includes('ThÃ nh cÃ´ng'))){output='âœ… THÃ€NH CÃ”NG:\n'+output;outputEl.style.background='#e8f5e9';outputEl.style.color='#4CAF50';}else{outputEl.style.background='#f4f4f4';outputEl.style.color='#333';}outputEl.textContent=output;}
        function closeOtpModal(){document.getElementById('otp-modal').classList.remove('active');document.getElementById('otp-input').value='';}
        function closeResetModal(){document.getElementById('reset-modal').classList.remove('active');document.getElementById('new-pwd').value='';document.getElementById('confirm-pwd').value='';resetToken=null;hideForgotPassword();}
        async function autoLoginAfterVerify(email){showOutput({msg:'âœ… Email Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c thá»±c!',note:'Äang tá»± Ä‘á»™ng Ä‘Äƒng nháº­p...'});await new Promise(r=>setTimeout(r,1500));const e=document.getElementById('login-email'),p=document.getElementById('login-pwd');e.value=email;p.value='';p.focus();showOutput({msg:'âœ… Email Ä‘Ã£ xÃ¡c thá»±c thÃ nh cÃ´ng!',note:'Vui lÃ²ng nháº­p máº­t kháº©u Ä‘á»ƒ Ä‘Äƒng nháº­p.'});document.getElementById('login-card').scrollIntoView({behavior:'smooth',block:'center'});}
        
        document.addEventListener('DOMContentLoaded',()=>{const u=new URLSearchParams(window.location.search),a=u.get('access_token'),r=u.get('refresh_token'),e=u.get('error'),v=u.get('verified'),em=u.get('email');if(a&&r){accessToken=a;refreshToken=r;updateAuthStatus();getAndSendLocation(a);showOutput({msg:'âœ… ÄÄƒng nháº­p báº±ng Google thÃ nh cÃ´ng!',note:'Token Ä‘Ã£ Ä‘Æ°á»£c lÆ°u. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c chá»©c nÄƒng.'});window.history.replaceState({},document.title,"/");}else if(e){showOutput({error:'Lá»—i Ä‘Äƒng nháº­p Google: '+e},true);window.history.replaceState({},document.title,"/");}else if(v==='true'){if(em){autoLoginAfterVerify(em);}else{showOutput({msg:'âœ… Email Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c thá»±c thÃ nh cÃ´ng!',note:'Báº¡n cÃ³ thá»ƒ Ä‘Äƒng nháº­p ngay bÃ¢y giá».'});}window.history.replaceState({},document.title,"/");}updateAuthStatus();window.addEventListener('message',e=>{if(e.data.type==='EMAIL_VERIFIED'){if(e.data.email){autoLoginAfterVerify(e.data.email);}else{showOutput({msg:'âœ… Email Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c thá»±c thÃ nh cÃ´ng!',note:'Báº¡n cÃ³ thá»ƒ Ä‘Äƒng nháº­p ngay bÃ¢y giá».'});}}});});
        
        function loginWithGoogle(){window.location.href=`${API_URL}/login/google`;}
        
        document.getElementById('register-form').addEventListener('submit',async function(e){e.preventDefault();const btn=e.submitter,txt=btn.textContent;btn.textContent='â³ Äang Ä‘Äƒng kÃ½...';btn.disabled=true;const email=document.getElementById('reg-email').value.trim();try{const res=await fetch(`${API_URL}/register`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name:document.getElementById('reg-name').value.trim(),email:email,pwd:document.getElementById('reg-pwd').value})});const result=await res.json();showOutput(result,!res.ok);if(res.ok){verifiedEmail=email;e.target.reset();setTimeout(()=>{showOutput({msg:result.msg,note:'ğŸ“§ Vui lÃ²ng kiá»ƒm tra há»™p thÆ° email (ká»ƒ cáº£ Spam/Junk) Ä‘á»ƒ xÃ¡c thá»±c tÃ i khoáº£n.'});},500);}}catch(err){showOutput({error:'KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n server: '+err.message},true);}finally{btn.textContent=txt;btn.disabled=false;}});
        
        document.getElementById('login-form').addEventListener('submit',async function(e){e.preventDefault();const btn=e.submitter,txt=btn.textContent;btn.textContent='â³ Äang Ä‘Äƒng nháº­p...';btn.disabled=true;try{const res=await fetch(`${API_URL}/login`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:document.getElementById('login-email').value.trim(),pwd:document.getElementById('login-pwd').value})});const result=await res.json();if(res.ok){accessToken=result.access_token;refreshToken=result.refresh_token;updateAuthStatus();getAndSendLocation(accessToken);showOutput({msg:'âœ… ÄÄƒng nháº­p thÃ nh cÃ´ng!',user:result.user});e.target.reset();}else{showOutput(result,true);}}catch(err){showOutput({error:'KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n server: '+err.message},true);}finally{btn.textContent=txt;btn.disabled=false;}});
        
        document.getElementById('forgot-form').addEventListener('submit',async function(e){e.preventDefault();const btn=e.submitter,txt=btn.textContent;btn.textContent='â³ Äang gá»­i...';btn.disabled=true;forgotEmail=document.getElementById('forgot-email').value.trim();try{const res=await fetch(`${API_URL}/forgot-password`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:forgotEmail})});const result=await res.json();showOutput(result,!res.ok);if(res.ok){document.getElementById('otp-modal').classList.add('active');document.getElementById('otp-input').focus();}}catch(err){showOutput({error:'KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n server: '+err.message},true);}finally{btn.textContent=txt;btn.disabled=false;}});
        
        document.getElementById('otp-form').addEventListener('submit',async function(e){e.preventDefault();const btn=e.submitter,txt=btn.textContent;btn.textContent='â³ Äang xÃ¡c thá»±c...';btn.disabled=true;const otp=document.getElementById('otp-input').value.trim();if(otp.length!==6||!/^\d+$/.test(otp)){showOutput({msg:'OTP pháº£i lÃ  6 chá»¯ sá»‘'},true);btn.textContent=txt;btn.disabled=false;return;}try{const res=await fetch(`${API_URL}/verify-otp`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:forgotEmail,otp:otp})});const result=await res.json();if(res.ok){resetToken=result.reset_token;closeOtpModal();document.getElementById('reset-modal').classList.add('active');document.getElementById('new-pwd').focus();showOutput(result);}else{showOutput(result,true);}}catch(err){showOutput({error:'KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n server: '+err.message},true);}finally{btn.textContent=txt;btn.disabled=false;}});
        
        document.getElementById('reset-form').addEventListener('submit',async function(e){e.preventDefault();const btn=e.submitter,txt=btn.textContent,newPwd=document.getElementById('new-pwd').value,confirmPwd=document.getElementById('confirm-pwd').value;if(newPwd!==confirmPwd){showOutput({msg:'Máº­t kháº©u xÃ¡c nháº­n khÃ´ng khá»›p'},true);return;}if(newPwd.length<6){showOutput({msg:'Máº­t kháº©u pháº£i cÃ³ Ã­t nháº¥t 6 kÃ½ tá»±'},true);return;}btn.textContent='â³ Äang Ä‘áº·t láº¡i...';btn.disabled=true;try{const res=await fetch(`${API_URL}/reset-password`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({reset_token:resetToken,new_pwd:newPwd})});const result=await res.json();showOutput(result,!res.ok);if(res.ok){setTimeout(()=>{closeResetModal();},2000);}}catch(err){showOutput({error:'KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n server: '+err.message},true);}finally{btn.textContent=txt;btn.disabled=false;}});
        
        document.getElementById('profile-button').addEventListener('click',async function(){if(!accessToken)return;this.textContent='â³ Äang táº£i...';this.disabled=true;try{const res=await fetch(`${API_URL}/profile`,{method:'GET',headers:{'Authorization':`Bearer ${accessToken}`}});const result=await res.json();if(res.ok){showOutput({msg:'âœ… ThÃ´ng tin profile:',profile:result});}else{showOutput(result,true);if(res.status===401){accessToken=null;refreshToken=null;updateAuthStatus();}}}catch(err){showOutput({error:'KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n server: '+err.message},true);}finally{this.textContent='ğŸ‘¤ Xem Profile';this.disabled=false;}});
        
        document.getElementById('refresh-button').addEventListener('click',async function(){if(!refreshToken)return;this.textContent='â³ Äang lÃ m má»›i...';this.disabled=true;try{const res=await fetch(`${API_URL}/refresh`,{method:'POST',headers:{'Authorization':`Bearer ${refreshToken}`}});const result=await res.json();if(res.ok){accessToken=result.access_token;showOutput({msg:'âœ… LÃ m má»›i token thÃ nh cÃ´ng!'});}else{showOutput(result,true);if(res.status===401){accessToken=null;refreshToken=null;updateAuthStatus();}}}catch(err){showOutput({error:'KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n server: '+err.message},true);}finally{this.textContent='ğŸ”„ LÃ m má»›i Token';this.disabled=false;}});
        
        document.getElementById('logout-button').addEventListener('click',async function(){if(!refreshToken)return;this.textContent='â³ Äang Ä‘Äƒng xuáº¥t...';this.disabled=true;try{const res=await fetch(`${API_URL}/logout`,{method:'POST',headers:{'Authorization':`Bearer ${refreshToken}`}});const result=await res.json();accessToken=null;refreshToken=null;updateAuthStatus();showOutput({msg:'âœ… ÄÄƒng xuáº¥t thÃ nh cÃ´ng!'});}catch(err){showOutput({error:'KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n server: '+err.message},true);}finally{this.textContent='ğŸšª ÄÄƒng xuáº¥t';this.disabled=false;}});
        
        document.getElementById('otp-input').addEventListener('input',function(e){this.value=this.value.replace(/[^0-9]/g,'');});
    </script>
</body>
</html>